<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <title>トップ</title>
</head>

<body>
  <h1 th:text="'ようこそ ' + ${username} + ' さん'">ようこそ</h1>

  <!-- ゲーム選択セクションを追加 -->
  <section id="game-select">
    <h2>ゲームを選択してください</h2>
    <div>
      <button id="tictactoe-btn" type="button" data-slug="tictactoe">マルバツゲーム</button>
      <button id="othello-btn" type="button" data-slug="othello">オセロ</button>
      <button id="gomoku-btn" type="button" data-slug="gomoku">五目並べ</button>
      <button id="concentration-btn" type="button" data-slug="concentration">神経衰弱</button>
      <button id="uno-btn" type="button" data-slug="uno">UNO</button>
      <button id="daifugo-btn" type="button" data-slug="daifugo">大老二（大富豪）</button>
    </div>
    <div style="margin-top:1em;">
      <button id="start-matching-btn" type="button">マッチング開始</button>
    </div>
  </section>

  <script>
    (function () {
      const gameButtons = document.querySelectorAll('#game-select button[data-slug]');
      const startBtn = document.getElementById('start-matching-btn');
      let selectedGameSlug = null;
      let selectedGameLabel = null;

      gameButtons.forEach(btn => {
        btn.addEventListener('click', function () {
          // 選択状態を管理
          gameButtons.forEach(b => { b.style.backgroundColor = ''; b.style.border = ''; });
          this.style.backgroundColor = '#cce5ff';
          this.style.border = '1px solid #004085';
          selectedGameSlug = this.getAttribute('data-slug');
          selectedGameLabel = this.textContent;
        });
      });

      startBtn.addEventListener('click', function () {
        if (!selectedGameSlug) {
          alert('ゲームを選択してください。');
          return;
        }
        // 選択済みのゲームスラッグをクエリパラメータで /matching に遷移
        const url = '/matching?game=' + encodeURIComponent(selectedGameSlug);
        window.location.href = url;
      });
    })();
  </script>

  <form th:action="@{/logout}" method="post">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    <button type="submit">ログアウト</button>
  </form>
</body>

</html>
