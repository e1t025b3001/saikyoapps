<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <title th:text="#{title.marubatsu}">マルバツゲーム</title>
  <link rel="stylesheet" th:href="@{/css/main.css}" />
  <link rel="stylesheet" th:href="@{/css/marubatsu.css}" />
  <style>
    /* 最小限のレイアウト残し（機能に影響しない） */
    #board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      max-width: 360px;
    }

    .cell {
      user-select: none
    }
  </style>
</head>

<body th:attr="data-game=${game}">
  <div class="header">
    <div class="container nav">
      <div class="brand">SaikyoApps</div>
    </div>
  </div>

  <main class="container section-center">
    <h1 th:text="#{title.marubatsu}">マルバツゲーム</h1>

    <form th:action="@{/match/forfeit}" method="post">
      <input type="hidden" name="game" th:value="${game}" />
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
      <button type="submit" class="btn secondary" th:text="#{button.forfeit}">戻る（投降）</button>
    </form>

    <div id="game" class="card" style="padding:1rem; margin-top:1rem;">
      <div id="status" th:text="#{game.status.turn}">現在の手番: <span id="currentPlayer">先手 (X)</span></div>
      <div id="board" class="tictactoe game-board" style="margin-top:0.75rem;">
        <div class="cell" data-row="0" data-col="0"></div>
        <div class="cell" data-row="0" data-col="1"></div>
        <div class="cell" data-row="0" data-col="2"></div>

        <div class="cell" data-row="1" data-col="0"></div>
        <div class="cell" data-row="1" data-col="1"></div>
        <div class="cell" data-row="1" data-col="2"></div>

        <div class="cell" data-row="2" data-col="0"></div>
        <div class="cell" data-row="2" data-col="1"></div>
        <div class="cell" data-row="2" data-col="2"></div>
      </div>

      <div id="result" style="margin-top:10px;font-weight:bold"></div>
    </div>
  </main>

  <!-- CSRF hidden for JS -->
  <input type="hidden" name="_csrf" th:value="${_csrf.token}" />
  <!-- matchId hidden for JS -->
  <input type="hidden" id="matchId" name="matchId" th:value="${matchId}" />

  <script src="/js/marubatsu.js"></script>
</body>

</html>
