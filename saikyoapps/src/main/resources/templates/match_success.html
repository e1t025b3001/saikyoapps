<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <title>マッチング成功</title>
</head>

<body>
  <h1>マッチング成功！まもなくゲーム画面に移動します。</h1>
  <p th:text="'ゲーム: ' + ${game}">ゲーム</p>

  <!-- hidden inputs を使ってサーバ側からの値を JS で安全に取得する -->
  <input type="hidden" id="gameInput" th:value="${game}" />
  <input type="hidden" id="matchIdInput" th:value="${matchId}" />

  <script>
    (function () {
      // hidden input から安全に値を取得
      const gameEl = document.getElementById('gameInput');
      const matchEl = document.getElementById('matchIdInput');
      const game = gameEl ? gameEl.value : 'marubatsu';
      const matchId = matchEl ? matchEl.value : null;

      setTimeout(function () {
        let url = '/' + encodeURIComponent(game);
        if (matchId) url += '?matchId=' + encodeURIComponent(matchId);
        window.location.href = url;
      }, 1200);
    })();
  </script>

  <a th:href="@{/}">ゲーム選択に戻る</a>
</body>

</html>
